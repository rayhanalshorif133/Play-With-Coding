import{IO as y,Parsing as w,scanFiles as h}from"@tailwindcss/oxide";import g from"path";import{compile as S,optimizeCss as x}from"tailwindcss";function M(){let r=null,l=new Set,a=new Set,u=!1;function d(e){let[t]=e.split("?",2);return g.extname(t).slice(1)==="css"}function c(){if(!r)return;let e=[];for(let t of a.values()){let i=r.moduleGraph.getModuleById(t);if(!i){a.delete(t);continue}r.moduleGraph.invalidateModule(i),e.push({type:`${i.type}-update`,path:i.url,acceptedPath:i.url,timestamp:Date.now()})}e.length>0&&r.hot.send({type:"update",updates:e})}function f(e,t){let i=!1;for(let n of h([{content:e,extension:t}],y.Sequential|w.Sequential)){if(!i){if(l.has(n))continue;i=!0}l.add(n)}return i}function p(e){return S(e).build(Array.from(l))}function v(e){return x(p(e),{minify:u})}let o=(()=>{let e=50,t,i,n=!1;return{tick(){n||(t&&clearTimeout(t),t=setTimeout(i,e))},complete:new Promise(s=>{i=()=>{n=!0,s()}})}})();return[{name:"@tailwindcss/vite:scan",enforce:"pre",configureServer(e){r=e},async configResolved(e){u=e.build.cssMinify!==!1},transformIndexHtml(e){o.tick();let t=f(e,"html");r&&t&&c()},transform(e,t){if(o.tick(),t.includes("/.vite/"))return;let[i]=t.split("?",2),n=g.extname(i).slice(1);n===""||n==="css"||(f(e,n),r&&c())}},{name:"@tailwindcss/vite:generate:serve",apply:"serve",async transform(e,t){if(!(!d(t)||!e.includes("@tailwind")))return a.add(t),await o.complete,{code:p(e)}}},{name:"@tailwindcss/vite:generate:build",enforce:"post",apply:"build",generateBundle(e,t){for(let i in t){let n=t[i];if(n.type!=="asset"||!d(i))continue;let s=n.source,m=s instanceof Uint8Array?new TextDecoder().decode(s):s;m.includes("@tailwind")&&(n.source=v(m))}}}]}export{M as default};
